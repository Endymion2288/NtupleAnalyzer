# ==============================================================================
# jup_mc.sub - HTCondor submit file for JUP MC analysis
# ==============================================================================
# Submit various JUP MC modes: SPS, DPS_1, DPS_2, DPS_3, TPS
#
# Usage:
#   condor_submit jup_mc.sub                    # Submit DPS_1 (default)
#   condor_submit jup_mc.sub MODE=SPS           # Submit specific mode
#   condor_submit jup_mc.sub MODE=DPS_1,DPS_2   # Submit multiple modes
#   condor_submit jup_mc.sub MODE=ALL           # Submit all modes
# ==============================================================================

# Job configuration
universe = vanilla
executable = ./run_wrapper.sh

# Default parameters (can be overridden)
MODE = DPS_1
JOBS = 8
MAX_EVENTS = -1
JPSI_MUON_ID = soft
UPS_MUON_ID = tight

# Arguments passed to run_wrapper.sh
arguments = "run_jup_mc_ntuple.sh -m $(MODE) -j $(JOBS) -n $(MAX_EVENTS) --jpsi-muon-id $(JPSI_MUON_ID) --ups-muon-id $(UPS_MUON_ID)"

# Log files
log_dir = logs/jup_mc
output = $(log_dir)/jup_mc_$(MODE)_$(Cluster)_$(Process).out
error = $(log_dir)/jup_mc_$(MODE)_$(Cluster)_$(Process).err
log = $(log_dir)/jup_mc_$(MODE)_$(Cluster)_$(Process).log

# Resource requests
request_memory = 48000
request_cpus = $(JOBS)
request_disk = 10G

# Job flavor (max runtime)
# espresso = 20min, microcentury = 1h, longlunch = 2h, workday = 8h
# tomorrow = 1d, testmatch = 3d, nextweek = 1w
+JobFlavour = "workday"

# File transfer settings
should_transfer_files = YES
when_to_transfer_output = ON_EXIT
transfer_output_files = output

# Environment and proxy
getenv = True
use_x509userproxy = True
x509userproxy = /afs/cern.ch/user/x/xcheng/x509up_u180107

# Notification
notification = Error
notify_user = xcheng@cern.ch

# Requirements
requirements = (OpSysAndVer =?= "AlmaLinux9")

# Queue
queue
